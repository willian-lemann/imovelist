generator client {
  provider = "prisma-client"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
}

model add_listing_indices {
  id         Int       @id @default(autoincrement())
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
}

model adonis_schema {
  id             Int       @id @default(autoincrement())
  name           String    @db.VarChar(255)
  batch          Int
  migration_time DateTime? @default(now()) @db.Timestamptz(6)
}

model adonis_schema_versions {
  version Int @id
}

model galleries {
  id         Int       @id @default(autoincrement())
  listing_id Int?
  url        String    @db.VarChar(255)
  filename   String    @db.VarChar(255)
  mime_type  String?   @db.VarChar(255)
  size       Int?
  order      Int?      @default(0)
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
  listings   listings? @relation(fields: [listing_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "galleries_listing_id_foreign")

  @@index([listing_id, order], map: "galleries_listing_id_order_index")
}

model listings {
  id                Int         @id @default(autoincrement())
  agent_id          Int?
  name              String?     @db.VarChar(255)
  link              String?     @db.VarChar(255)
  image             String?     @db.VarChar(255)
  address           String?     @db.VarChar(255)
  price             String?     @db.VarChar(255)
  area              Int?
  bedrooms          Int?
  type              String?     @db.VarChar(255)
  for_sale          Boolean?
  parking           Int?
  content           String?
  photos            Json?       @default("[]")
  agency            String?     @db.VarChar(255)
  bathrooms         Int?
  ref               String?     @db.VarChar(255)
  placeholder_image String?     @db.VarChar(255)
  published         Boolean     @default(false)
  created_at        DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at        DateTime?   @default(now()) @db.Timestamptz(6)
  galleries         galleries[]
  users             users?      @relation(fields: [agent_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "listings_agent_id_foreign")

  @@index([address(ops: raw("gin_trgm_ops"))], map: "idx_listings_address", type: Gin)
  @@index([created_at(sort: Desc)], map: "idx_listings_created_at")
  @@index([for_sale], map: "idx_listings_for_sale")
  @@index([price], map: "idx_listings_price")
  @@index([ref], map: "idx_listings_ref")
  @@index([type], map: "idx_listings_type")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model policies {
  id         Int       @id @default(autoincrement())
  created_at DateTime? @db.Timestamptz(6)
  updated_at DateTime? @db.Timestamptz(6)
}

model scrapped_infos {
  id             Int       @id @default(autoincrement())
  total_pages    Int?
  total_listings Int?
  agency         String?   @db.VarChar(255)
  created_at     DateTime? @db.Timestamptz(6)
  updated_at     DateTime? @db.Timestamptz(6)
}

model scrapped_listings {
  id                Int       @id @default(autoincrement())
  name              String?   @db.VarChar(255)
  link              String?   @db.VarChar(255)
  image             String?   @db.VarChar(255)
  address           String?   @db.VarChar(255)
  price             Decimal?  @db.Decimal(12, 2)
  area              String?   @db.VarChar(255)
  bedrooms          Int?
  type              String?   @db.VarChar(255)
  for_sale          Boolean?
  parking           Int?
  content           String?
  photos            Json?     @db.Json
  agency            String?   @db.VarChar(255)
  bathrooms         Int?
  ref               String?   @db.VarChar(255)
  placeholder_image String?   @db.VarChar(255)
  agent_id          String?   @db.VarChar(255)
  published         Boolean   @default(false)
  created_at        DateTime? @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @default(now()) @db.Timestamptz(6)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model subscriptions {
  id                     Int       @id @default(autoincrement())
  user_id                Int
  stripe_customer_id     String    @db.VarChar(255)
  stripe_subscription_id String    @unique(map: "subscriptions_stripe_subscription_id_unique") @db.VarChar(255)
  stripe_price_id        String    @db.VarChar(255)
  status                 String?   @default("incomplete")
  current_period_end     DateTime? @db.Timestamptz(6)
  created_at             DateTime? @db.Timestamptz(6)
  updated_at             DateTime? @db.Timestamptz(6)
  users                  users     @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "subscriptions_user_id_foreign")
}

model users {
  id                 Int             @id @default(autoincrement())
  full_name          String?         @db.VarChar(255)
  email              String          @unique(map: "users_email_unique") @db.VarChar(254)
  password           String          @db.VarChar(255)
  created_at         DateTime        @db.Timestamptz(6)
  updated_at         DateTime?       @db.Timestamptz(6)
  profile_photo      String?         @db.VarChar(255)
  whatsapp           String?         @db.VarChar(255)
  profile_url        String?         @unique(map: "users_profile_url_unique") @db.VarChar(255)
  logo               String?         @db.VarChar(255)
  stripe_customer_id String?         @unique(map: "users_stripe_customer_id_unique") @db.VarChar(255)
  listings           listings[]
  subscriptions      subscriptions[]
}
